108-2 大數據分析方法 作業一
================
李家郁

搞不清楚各行各業的薪資差異嗎? 念研究所到底對第一份工作的薪資影響有多大? CP值高嗎? 透過分析**初任人員平均經常性薪資**-
（107年）<https://data.gov.tw/dataset/6647>
（104-105年）<http://ipgod.nchc.org.tw/dataset/a17000000j-020066>
，可初步了解台灣近幾年各行各業、各學歷的起薪。

## 比較104年度和107年度大學畢業者的薪資資料

### 資料匯入與處理

``` r
library(readr)
library(dplyr)
```

    ## 
    ## Attaching package: 'dplyr'

    ## The following objects are masked from 'package:stats':
    ## 
    ##     filter, lag

    ## The following objects are masked from 'package:base':
    ## 
    ##     intersect, setdiff, setequal, union

``` r
salary104 <- read_csv("C:/Users/USER/Desktop/salary104.csv")#讀檔
```

    ## Parsed with column specification:
    ## cols(
    ##   年度 = col_double(),
    ##   大職業別 = col_character(),
    ##   `經常性薪資-薪資` = col_double(),
    ##   `經常性薪資-女/男` = col_character(),
    ##   `國中及以下-薪資` = col_character(),
    ##   `國中及以下-女/男` = col_character(),
    ##   `高中或高職-薪資` = col_character(),
    ##   `高中或高職-女/男` = col_character(),
    ##   `專科-薪資` = col_character(),
    ##   `專科-女/男` = col_character(),
    ##   `大學-薪資` = col_character(),
    ##   `大學-女/男` = col_character(),
    ##   `研究所及以上-薪資` = col_character(),
    ##   `研究所及以上-女/男` = col_character()
    ## )

``` r
salary107 <- read_csv("C:/Users/USER/Desktop/salary107.csv")#讀檔
```

    ## Parsed with column specification:
    ## cols(
    ##   年度 = col_double(),
    ##   大職業別 = col_character(),
    ##   `經常性薪資-薪資` = col_character(),
    ##   `經常性薪資-女/男` = col_character(),
    ##   `國中及以下-薪資` = col_character(),
    ##   `國中及以下-女/男` = col_character(),
    ##   `高中或高職-薪資` = col_character(),
    ##   `高中或高職-女/男` = col_character(),
    ##   `專科-薪資` = col_character(),
    ##   `專科-女/男` = col_character(),
    ##   `大學-薪資` = col_character(),
    ##   `大學-女/男` = col_character(),
    ##   `研究所-薪資` = col_character(),
    ##   `研究所-女/男` = col_character()
    ## )

``` r
#第一題

#修改資料型態
salary104[,c(-1,-2)]<-apply(salary104[,c(-1,-2)],2,function(x){as.numeric(gsub("—|…",NA,x))})%>%as.data.frame()
salary107[,c(-1,-2)]<-apply(salary107[,c(-1,-2)],2,function(x){as.numeric(gsub("—|…",NA,x))})%>%as.data.frame()

#用anti_join比較不同處
anti104<-anti_join(salary104,salary107,by ="大職業別")
anti107<-anti_join(salary107,salary104,by ="大職業別")

#統一職業名稱
salary104$大職業別<-gsub("部門","",salary104$大職業別)
salary104$大職業別<-gsub("、","_",salary104$大職業別)
salary104$大職業別<-gsub("營造業","營建工程",salary104$大職業別)
salary104$大職業別<-gsub("資訊及通訊傳播業","出版、影音製作、傳播及資通訊服務業",salary104$大職業別)
salary104$大職業別<-gsub("教育服務業","教育業",salary104$大職業別)
salary104$大職業別<-gsub("醫療保健服務業","醫療保健業",salary104$大職業別)

#Join 104和107年度表格
salary<-left_join(salary104, salary107, by ="大職業別" )
salary$Calculation<-salary$`大學-薪資.y`/salary$`大學-薪資.x`#計算107年度大學畢業薪資 / 104年度大學畢業薪資
```

### 107年度薪資較104年度薪資高的職業有哪些?

``` r
#107年度薪資較104年度薪資高的職業
salarytop10<- select(salary,大職業別,Calculation)%>%
  filter(Calculation>1)%>%
  arrange(desc(Calculation))%>%
  head(10)
knitr::kable(salarytop10)
```

| 大職業別                   | Calculation |
| :--------------------- | ----------: |
| 專業\_科學及技術服務業-服務及銷售工作人員 |    1.158908 |
| 教育業-服務及銷售工作人員          |    1.132338 |
| 不動產業-技術員及助理專業人員        |    1.130807 |
| 住宿及餐飲業-服務及銷售工作人員       |    1.108842 |
| 藝術\_娛樂及休閒服務業-事務支援人員    |    1.097632 |
| 金融及保險業-技藝\_機械設備操作及組裝人員 |    1.097194 |
| 教育業                    |    1.096177 |
| 教育業-事務支援人員             |    1.095800 |
| 用水供應及污染整治業-專業人員        |    1.086330 |
| 教育業-專業人員               |    1.086267 |

從表格可看出107年度薪資較104年度薪資高的前十個職業中“教育業”就佔了四個，其中“專業\_科學及技術服務業-服務及銷售工作人員”的提高比例最多。

### 提高超過5%的職業有哪些?

``` r
#提高超過5%的職業
salaryraise<- select(salary,大職業別,Calculation)%>%
  filter(Calculation>1.05)%>%
  arrange(desc(Calculation))
knitr::kable(salaryraise)
```

| 大職業別                         | Calculation |
| :--------------------------- | ----------: |
| 專業\_科學及技術服務業-服務及銷售工作人員       |    1.158908 |
| 教育業-服務及銷售工作人員                |    1.132338 |
| 不動產業-技術員及助理專業人員              |    1.130807 |
| 住宿及餐飲業-服務及銷售工作人員             |    1.108842 |
| 藝術\_娛樂及休閒服務業-事務支援人員          |    1.097632 |
| 金融及保險業-技藝\_機械設備操作及組裝人員       |    1.097194 |
| 教育業                          |    1.096177 |
| 教育業-事務支援人員                   |    1.095800 |
| 用水供應及污染整治業-專業人員              |    1.086330 |
| 教育業-專業人員                     |    1.086267 |
| 出版、影音製作、傳播及資通訊服務業-專業人員       |    1.082141 |
| 住宿及餐飲業                       |    1.081297 |
| 用水供應及污染整治業-技藝\_機械設備操作及組裝人員   |    1.072507 |
| 營建工程-服務及銷售工作人員               |    1.071877 |
| 電力及燃氣供應業-技藝\_機械設備操作及組裝人員     |    1.071044 |
| 住宿及餐飲業-事務支援人員                |    1.070685 |
| 運輸及倉儲業-技術員及助理專業人員            |    1.070003 |
| 服務業-服務及銷售工作人員                |    1.069120 |
| 金融及保險業-技術員及助理專業人員            |    1.069093 |
| 金融及保險業-服務及銷售工作人員             |    1.068089 |
| 出版、影音製作、傳播及資通訊服務業-事務支援人員     |    1.067475 |
| 工業及服務業-服務及銷售工作人員             |    1.066587 |
| 不動產業                         |    1.066421 |
| 運輸及倉儲業-技藝\_機械設備操作及組裝人員       |    1.065723 |
| 不動產業-技藝\_機械設備操作及組裝人員         |    1.063403 |
| 住宿及餐飲業-技藝\_機械設備操作及組裝人員       |    1.062300 |
| 不動產業-服務及銷售工作人員               |    1.062117 |
| 支援服務業-服務及銷售工作人員              |    1.060903 |
| 營建工程-專業人員                    |    1.060715 |
| 出版、影音製作、傳播及資通訊服務業            |    1.060594 |
| 運輸及倉儲業-事務支援人員                |    1.060240 |
| 藝術\_娛樂及休閒服務業                 |    1.059809 |
| 醫療保健業-服務及銷售工作人員              |    1.057476 |
| 其他服務業-服務及銷售工作人員              |    1.056991 |
| 營建工程-事務支援人員                  |    1.056960 |
| 藝術\_娛樂及休閒服務業-專業人員            |    1.056577 |
| 運輸及倉儲業                       |    1.056260 |
| 藝術\_娛樂及休閒服務業-技藝\_機械設備操作及組裝人員 |    1.055985 |
| 製造業-技術員及助理專業人員               |    1.055015 |
| 運輸及倉儲業-服務及銷售工作人員             |    1.054221 |
| 金融及保險業                       |    1.053951 |
| 工業-技術員及助理專業人員                |    1.053411 |
| 不動產業-事務支援人員                  |    1.053410 |
| 金融及保險業-專業人員                  |    1.052928 |
| 批發及零售業-服務及銷售工作人員             |    1.052818 |
| 製造業-專業人員                     |    1.052507 |
| 出版、影音製作、傳播及資通訊服務業-服務及銷售工作人員  |    1.052499 |
| 出版、影音製作、傳播及資通訊服務業-技術員及助理專業人員 |    1.052421 |
| 工業-專業人員                      |    1.052347 |
| 用水供應及污染整治業                   |    1.051960 |
| 藝術\_娛樂及休閒服務業-技術員及助理專業人員      |    1.051427 |
| 營建工程                         |    1.050670 |
| 工業-技藝\_機械設備操作及組裝人員           |    1.050328 |

### 主要的職業種別是哪些種類呢?

``` r
#主要的職業種別;字串處理;分析出現次數
job<-strsplit(salaryraise$大職業別,"-")%>%sapply("[",1)
knitr::kable(table(job))
```

| job               | Freq |
| :---------------- | ---: |
| 工業                |    3 |
| 工業及服務業            |    1 |
| 不動產業              |    5 |
| 支援服務業             |    1 |
| 出版、影音製作、傳播及資通訊服務業 |    5 |
| 用水供應及污染整治業        |    3 |
| 住宿及餐飲業            |    4 |
| 批發及零售業            |    1 |
| 其他服務業             |    1 |
| 服務業               |    1 |
| 金融及保險業            |    5 |
| 專業\_科學及技術服務業      |    1 |
| 教育業               |    4 |
| 運輸及倉儲業            |    5 |
| 電力及燃氣供應業          |    1 |
| 製造業               |    2 |
| 營建工程              |    4 |
| 醫療保健業             |    1 |
| 藝術\_娛樂及休閒服務業      |    5 |

提高超過5%的職業中主要以“不動產業”、“出版、影音製作、傳播及資通訊服務業”、“金融及保險業”、“運輸及倉儲業”、“藝術\_娛樂及休閒服務業”為主，這五個職業就佔了提高超過5%的職業中的一半左右。

## 男女同工不同酬現況分析

男女同工不同酬一直是性別平等中很重要的問題，分析資料來源為103到106年度的大學畢業薪資。

### 104和107年度的大學畢業薪資資料，哪些行業男生薪資比女生薪資多?

``` r
#第二題
#104年男生薪資比女生薪資多
men_higher104<-select(salary104,大職業別,`大學-女/男`)%>%
  filter(`大學-女/男`<100)%>%
  arrange(`大學-女/男`)%>%
  head(10)
knitr::kable(men_higher104)
```

| 大職業別                       | 大學-女/男 |
| :------------------------- | :----: |
| 電力及燃氣供應業-技藝\_機械設備操作及組裝人員   | 91.69  |
| 教育業-服務及銷售工作人員              | 91.90  |
| 礦業及土石採取業-技術員及助理專業人員        | 92.42  |
| 礦業及土石採取業-技藝\_機械設備操作及組裝人員   | 93.10  |
| 礦業及土石採取業                   | 95.28  |
| 其他服務業-事務支援人員               | 95.47  |
| 營建工程-技藝\_機械設備操作及組裝人員       | 95.64  |
| 用水供應及污染整治業-技藝\_機械設備操作及組裝人員 | 95.90  |
| 營建工程                       | 96.35  |
| 教育業                        | 96.44  |

``` r
#107年男生薪資比女生薪資多
men_higher107<-select(salary107,大職業別,`大學-女/男`)%>%
  filter(`大學-女/男`<100)%>%
  arrange(`大學-女/男`)%>%
  head(10)
knitr::kable(men_higher107)
```

| 大職業別                 | 大學-女/男 |
| :------------------- | :----: |
| 礦業及土石採取業-專業人員        | 96.02  |
| 電力及燃氣供應業-事務支援人員      | 96.96  |
| 礦業及土石採取業             | 97.11  |
| 營建工程                 | 97.52  |
| 教育業-事務支援人員           | 97.61  |
| 電力及燃氣供應業-服務及銷售工作人員   | 97.73  |
| 營建工程-技術員及助理專業人員      | 97.78  |
| 用水供應及污染整治業-專業人員      | 97.81  |
| 用水供應及污染整治業-服務及銷售工作人員 | 97.94  |
| 電力及燃氣供應業-專業人員        | 98.23  |

從表格發現男生薪資比女生薪資多的職業大部分與水電、土木有關。104和107年度的大學畢業薪資資料中可看出男女薪資比例差距有縮小，從104年91.69到107年變為96.02，代表男女同工不同酬的問題有持續改善。

### 哪些行業女生薪資比男生薪資多?

``` r
#104年女生薪資比男生薪資多
women_higher104<-select(salary104,大職業別,`大學-女/男`)%>%
  filter(`大學-女/男`>=100)%>%
  arrange(desc(`大學-女/男`))%>%
  head(10)
knitr::kable(women_higher104)
```

| 大職業別                         | 大學-女/男 |
| :--------------------------- | :----: |
| 專業\_科學及技術服務業-技藝\_機械設備操作及組裝人員 | 100.26 |
| 用水供應及污染整治業-服務及銷售工作人員         | 100.00 |
| 不動產業-技藝\_機械設備操作及組裝人員         | 100.00 |
| 醫療保健業-服務及銷售工作人員              | 100.00 |
| 其他服務業-專業人員                   | 100.00 |

``` r
#107年女生薪資比男生薪資多
women_higher107<-select(salary107,大職業別,`大學-女/男`)%>%
  filter(`大學-女/男`>=100)%>%
  arrange(desc(`大學-女/男`))%>%
  head(10)
knitr::kable(women_higher107)
```

| 大職業別                              | 大學-女/男 |
| :-------------------------------- | :----: |
| 礦業及土石採取業-技藝\_機械設備操作及組裝人員          |  100   |
| 出版、影音製作、傳播及資通訊服務業-技藝\_機械設備操作及組裝人員 |  100   |
| 金融及保險業-服務及銷售工作人員                  |  100   |
| 金融及保險業-技藝\_機械設備操作及組裝人員            |  100   |
| 不動產業-服務及銷售工作人員                    |  100   |
| 不動產業-技藝\_機械設備操作及組裝人員              |  100   |
| 專業\_科學及技術服務業-服務及銷售工作人員            |  100   |
| 教育業-服務及銷售工作人員                     |  100   |

104年度的大學畢業薪資資料中只有“專業\_科學及技術服務業-技藝\_機械設備操作及組裝人員”是女生薪資高於男生，但高出的比例也不多;107年度的大學畢業薪資沒有任何職業是女生薪水比男生高的，而且也只有少數行業是男女薪水一樣的，代表男女同工不同酬的問題還是存在的。

## 研究所薪資差異

以107年度的資料來看，哪個職業別念研究所最划算呢 (研究所學歷薪資與大學學歷薪資增加比例最多)?

``` r
#第三題
compare107<-select(salary107,大職業別,`大學-薪資`,`研究所-薪資`)
compare107<-mutate(compare107,rate107=salary107$`研究所-薪資`/salary107$`大學-薪資`)%>%
  arrange(desc(rate107))%>%
  head(10)
knitr::kable(compare107)
```

| 大職業別                   | 大學-薪資 | 研究所-薪資 |  rate107 |
| :--------------------- | :---: | :----: | -------: |
| 其他服務業                  | 25781 | 31909  | 1.237694 |
| 專業\_科學及技術服務業           | 29353 | 35381  | 1.205362 |
| 專業\_科學及技術服務業-專業人員      | 32460 | 39103  | 1.204652 |
| 教育業-事務支援人員             | 25908 | 30827  | 1.189864 |
| 出版、影音製作、傳播及資通訊服務業      | 29143 | 34503  | 1.183921 |
| 其他服務業-事務支援人員           | 26115 | 30830  | 1.180548 |
| 出版、影音製作、傳播及資通訊服務業-專業人員 | 31763 | 37479  | 1.179958 |
| 製造業                    | 28777 | 33916  | 1.178580 |
| 工業                     | 28850 | 33893  | 1.174801 |
| 工業及服務業                 | 28849 | 33880  | 1.174391 |

“其他服務業”是研究所學歷薪資增加比例最多的，也就是念研究所最划算的職業。

## 我有興趣的職業別薪資狀況分析

### 有興趣的職業別篩選，呈現薪資

``` r
#第四題
interest<-select(salary107,大職業別,`大學-薪資`,`研究所-薪資`)%>%
  filter(salary107$大職業別%in%c("出版、影音製作、傳播及資通訊服務業-技術員及助理專業人員","出版、影音製作、傳播及資通訊服務業-事務支援人員","運輸及倉儲業-專業人員","出版、影音製作、傳播及資通訊服務業-專業人員","運輸及倉儲業-技術員及助理專業人員"))
knitr::kable(interest)
```

| 大職業別                         | 大學-薪資 | 研究所-薪資 |
| :--------------------------- | :---: | :----: |
| 運輸及倉儲業-專業人員                  | 34788 | 38059  |
| 運輸及倉儲業-技術員及助理專業人員            | 31747 | 33304  |
| 出版、影音製作、傳播及資通訊服務業-專業人員       | 31763 | 37479  |
| 出版、影音製作、傳播及資通訊服務業-技術員及助理專業人員 | 28910 | 33643  |
| 出版、影音製作、傳播及資通訊服務業-事務支援人員     | 27464 | 30950  |

### 這些職業別研究所薪資與大學薪資差多少呢？

``` r
interest<-mutate(interest,薪資差=`研究所-薪資`-`大學-薪資`)
knitr::kable(interest[,c("大職業別","薪資差")])
```

| 大職業別                         | 薪資差  |
| :--------------------------- | :--: |
| 運輸及倉儲業-專業人員                  | 3271 |
| 運輸及倉儲業-技術員及助理專業人員            | 1557 |
| 出版、影音製作、傳播及資通訊服務業-專業人員       | 5716 |
| 出版、影音製作、傳播及資通訊服務業-技術員及助理專業人員 | 4733 |
| 出版、影音製作、傳播及資通訊服務業-事務支援人員     | 3486 |

我依然不想念研究所，比起念書我更想直接去上班增加實戰經驗，唸完研究所的薪資其實並沒有差很多，所以我堅持我的決定。
